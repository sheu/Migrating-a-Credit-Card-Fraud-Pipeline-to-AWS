

aws cloudformation deploy \
--stack-name fraud-pipeline-api \
--template-file fraud-pipeline-api-ecs-alb.yaml \
--capabilities CAPABILITY_NAMED_IAM \
--parameter-overrides \
ProjectName=fraud-pipeline \
Environment=dev \
ContainerImageUri=412799044451.dkr.ecr.us-east-1.amazonaws.com/fraud-pipeline-dev-api:amd64-v5 \
ModelS3Uri=s3://fraud-pipeline-sg-data-bucket/models/fraud_detection_model_latest/ \
ContainerPort=8000 \
HealthCheckPath=/docs \
DesiredCount=1 

aws ecs update-service --cluster fraud-pipeline-api-Cluster-EmNyUQrvjSQT --service arn:aws:ecs:us-east-1:412799044451:service/fraud-pipeline-api-Cluster-EmNyUQrvjSQT/fraud-pipeline-api-Service-5lWCjL2W1PMq --desired-count 0


aws ecs describe-services --cluster fraud-pipeline-api-Cluster-EmNyUQrvjSQT --services arn:aws:ecs:us-east-1:412799044451:service/fraud-pipeline-api-Cluster-EmNyUQrvjSQT/fraud-pipeline-api-Service-5lWCjL2W1PMq --query "services[0].{rollout:deployments[*].[status,rolloutState,rolloutStateReason,desiredCount,runningCount,pendingCount],events:events[0:15].[createdAt,message]}" --output json